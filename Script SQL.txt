CREATE TABLE EMPLOYE
  (
    NoEMP NUMBER (4) NOT NULL ,
    Nom   VARCHAR2 (40) NOT NULL ,
    MDP   VARCHAR2 (40) NOT NULL
  ) ;
ALTER TABLE EMPLOYE ADD CONSTRAINT EMPLOYE_PK PRIMARY KEY ( NoEMP ) ;

CREATE TABLE NIDS
  (
    IDNID              NUMBER (5) NOT NULL ,
    DateSignalement DATE NOT NULL ,
    Dimensions       CHAR (7) NOT NULL ,
    NoEMP           NUMBER (4) NOT NULL ,
    Emplacement     VARCHAR2 (80) NOT NULL ,
    Status          VARCHAR2 (10) NOT NULL
  ) ;
ALTER TABLE NIDS ADD CHECK ( Status IN ('RÉPARÉ', 'SIGNALÉ')) ;
ALTER TABLE NIDS ADD CONSTRAINT NIDS_PK PRIMARY KEY ( IDNID ) ;

ALTER TABLE NIDS ADD CONSTRAINT NIDS_EMPLOYE_FK FOREIGN KEY ( NoEMP ) REFERENCES EMPLOYE ( NoEMP ) ;

CREATE SEQUENCE NIDS_ID_SEQ START WITH 1 NOCACHE ORDER ;
CREATE OR REPLACE TRIGGER NIDS_ID_TRG BEFORE
  INSERT ON NIDS FOR EACH ROW WHEN (NEW.IDNID IS NULL) BEGIN :NEW.IDNID := NIDS_ID_SEQ.NEXTVAL;
END;
/
create or replace TRIGGER JOINDATE BEFORE INSERT ON NIDS
FOR EACH ROW
BEGIN
if :new.DateSignalement is null then select sysdate into :new.DateSignalement from dual;
end if;
END;